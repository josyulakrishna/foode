var table_backup='<tr class="micon"><td class="itname"><a style="color:green;text-decoration:none;" class="itname"></a></td> <td class="rstar" width="30%"></td></tr>';$(document).ready(function(){function a(){$("#menucontent").show();$.ajax({url:"/menulistview/"+rest_id+"/",success:function(a){if(a.menulists.length!=0){$("#menuresult").hide();$("#menutable").show();$("#plusitems").show();var b={"div#menutable":{"tmp<-menulists":{h4:"tmp.listname","tr.micon":{"itm<-tmp.menuitems":{"a.itname":"itm.itemname","a.itname@href":"/restaurants/?fooditem=#{itm.itemname}","td.rstar@id":"rstar#{itm.id}","td.rstar@rating":"itm.rrating"}}}}};$("#menucontent").render(a,b)}else{$("#menuresult").show();$("#menutable").hide()}$(".rstar").raty({start:function(){return $(this).attr("rating")},click:function(a,b){starid=$(this).attr("id");$.ajax({url:"/ratemenuitem/"+starid+"/"+a+"/",success:function(a){}})}})}})}function c(){$("div.additems-template:not(:first)").empty();$("div.additems-template:not(:first)").remove();$(".additemstolist").remove();$(".additem").remove()}function d(){$("div.menutable-template:not(:first)").remove();if($(".micon").length==0){$(table_backup).appendTo($("table"))}else{$(".micon:not(:first)").remove();$(".rstar").empty()}$(".listitems").remove();$(".remove").remove()}a();$("#plusitems").live("click",function(){$(".menutable-template").hide();$("#addmenuitems").show();$(this).hide();$.ajax({url:"/editmenulistview/"+rest_id+"/",success:function(a){if(a.menulists.length!=0){$("#resultadditems").hide();$(".catg").show();var b={"div.additems-template":{"tmp<-menulists":{h4:"#{tmp.listname}","p.new-fooditems":'<div id="itemsadd#{tmp.id}" class="additemstolist" align="center"></div><a class="btn additem" id="add#{tmp.id}" href="##{tmp.id}" style="text-decoration:none;text-align:center;" ><i class="icon-plus icon-black"></i></a><hr">'}}};$("#menuitems_content").render(a,b)}else{$("#resultadditems").show();$(".catg").hide();$("#doneitems").hide()}}})});$("#canceladd").live("click",function(){$(".menutable-template").show();$("#addmenuitems").hide();c();$("#plusitems").show()});var b=1;$(".additem").live("click",function(){$("#doneitems").show();var a=$(this).attr("id");var c='<hr"/"><input type="text" class="input-xlarge field listitems" name="listitem'+a+"z"+b+'" id="menuitemrem'+b+'" value="Item""/"><a href="#'+a+'" class="remove removeitems" style="text-decoration:none;text-align:center;" id="rem'+b+'">&nbsp&nbsp<i class="icon-remove icon-black"></i></a><br>';$(c).fadeIn("slow").appendTo("#items"+a);b++});$(".remove").live("click",function(){var a=$(this).attr("id");$("#menuitem"+a).remove();$("#"+a).remove();b--;if($(".listitems").length==0){$("#doneitems").hide()}});$("#doneitems").live("click",function(){$.ajax({data:$("#menuitemsform").serialize(),type:$("#menuitemsform").attr("method"),url:$("#menuitemsform").attr("action"),success:function(b){d();a();$(".menutable-template").show();$("#addmenuitems").hide();c();$("#plusitems").show()}});return false})})
